# 渔场仓储与成本分析静态演示系统

本项目为一个纯前端静态可点击原型，用于演示渔场商品（海产/饲料）库存与成本、领用、分析等核心业务流程。可直接打开 `index.html` 运行，无需构建与后端。

## 功能覆盖映射

| 需求表模块 | 子功能 | 演示实现说明 |
| ---------- | ------ | ------------ |
| 商品展示与操作 | 商品列表展示 | `/products` 模块：SKU/批次/库位/数量/状态/金额 |
| 库存管理 | 库存明细 | `/inventory` 模块：统计 metric + 明细表 + 预警高亮 |
| 库存管理 | 库存预算/预警 | 以安全库存对比实时状态（OK/LOW/OUT）展示 |
| 库存管理 | 库存增补/减耗 | 入库单、领用单、手动调整、批量调整 |
| SKU 管理 | 列表/新增/编辑/删除 | `/sku` 模块 |
| 分类管理 | 列表/CRUD | `/categories` 模块 |
| 采购入库 | 入库单与详情 | `/purchase` 构建 + 自动写入库存 + 运费分摊示例 |
| 领用出库 | 领用记录 | `/issue` 领用扣减库存 |
| 成本系统 | 成本分摊/库存成本 | `/cost`：平均法运费分摊 + 重算成本 |
| 资产占用 | 库存金额分析 | `/assets` 分类聚合 |
| 智能分析 | 消耗趋势/库存结构 | `/analytics` 图表示例（Chart.js） |
| 系统模块 | 日志 | `/logs` |
| 系统模块 | 设置 | `/settings`（扩展入口） |

## 运行方式

1. 直接双击 `index.html` 或使用简单静态服务器（可选）：
   ```bash
   npx serve .
   # 或 python3 -m http.server 8080
   ```
2. 浏览器访问后即可点击左侧导航体验。

## 交互亮点
- Hash 路由单页结构，不刷新页面。
- 可新增 SKU / 分类 / 库存记录。
- 采购入库自动写入库存并触发成本重算。
- 领用出库扣减库存并刷新状态（OK / LOW / OUT）。
- 成本核算内可手动点击“重新计算成本”模拟批处理。
- 图表使用 Chart.js，可替换成 ECharts。
- 导出 CSV 示例（商品列表）。
- 暗色 / 浅色主题切换。

## 成本逻辑（示例）
- 运费分摊：按采购单中各行数量比例分配。
- 单位分摊成本 = 分摊运费 / 该行数量。
- 库存当前成本 = 最近采购（含分摊后）平均值。
- 资产占用 = Σ (库存数量 * 成本单价)。

可进一步迭代为：
- FIFO / 移动加权 / 批次成本追踪。
- 期初结转与期间领用成本差异分析。
- 领用按部门、项目或养殖塘口维度分配。

## 可扩展建议
1. 权限体系：按角色隐藏敏感模块（如成本页）。
2. 实时预警：库存状态 + 剩余保质期 < 阈值推送。
3. 智能补货：基于历史日均消耗 = (过去 N 天领用数量 / N)。
4. 质量追溯：批次增加供应商批捕区块链溯源信息。
5. 数据持久化：用 LocalStorage / IndexedDB 或接后端 API。
6. 多单位换算：SKU 配置主单位与辅助单位换算率。
7. 批量导入：支持 CSV -> 解析成 SKU / 入库单。

## 代码结构说明
- `mock.js`：内存数据库与简易仓储仓储方法（Repo）。
- `components.js`：UI 基础组件（表格、分页、模态、提示）。
- `cost.js`：成本计算引擎示例。
- `analytics.js`：图表构建。
- `exporter.js`：导出能力封装。
- `app.js`：路由与各业务模块渲染。

## 快速修改
- 调整安全库存阈值：修改 `DB.skus[].safetyStock`。
- 增加初始数据：在 `mock.js` 里扩展数组。
- 新增模块：在 `Routes` 中添加路径函数，并在侧边栏 `<nav>` 中补链接。
- 接入真实后端：替换 `Repo` 中 CRUD 操作为 `fetch()`，返回 Promise 后刷新 UI。

## 安全库存 & 预警策略（建议）
| 状态 | 条件 |
| ---- | ---- |
| OK | qty >= safetyStock |
| LOW | 0 < qty < safetyStock |
| OUT | qty <= 0 |

可扩展：加入「即将过期」(剩余天数 < X)、合成状态（LOW+EXP）。

## 性能优化思路（若扩展为真实系统）
- 大表分页：后端分页 + 虚拟滚动（IntersectionObserver）。
- 图表懒加载：仅首次进入时初始化。
- 成本重算队列：长耗时以 Web Worker/Job Queue 处理。
- 数据缓存：ETag/Last-Modified 或 GraphQL 缓存。

## 授权
本演示仅为原型示例，可自由二次开发。

欢迎进一步需求：批次追溯、IoT 设备（水温/溶氧）联动库存策略、算法补货、预测分析等。
